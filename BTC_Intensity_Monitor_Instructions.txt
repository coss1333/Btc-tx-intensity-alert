# Пошаговая инструкция запуска программы BTC Transaction Intensity Monitor

## 1️⃣ Подготовка среды
1. Убедитесь, что установлен **Python 3.10+**.  
   Проверить можно командой:
   ```bash
   python --version
   ```

2. Скачайте и распакуйте архив **btc_tx_intensity_alert.zip**.

3. Откройте папку проекта в терминале.

4. Создайте виртуальное окружение и активируйте его:
   ```bash
   python -m venv .venv
   source .venv/bin/activate   # Для Windows: .venv\Scripts\activate
   ```

5. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

---

## 2️⃣ Настройка Telegram-бота
1. В Telegram найдите бота **@BotFather**.
2. Создайте нового бота:
   ```
   /newbot
   ```
   и получите **BOT TOKEN**.

3. Узнайте ваш **CHAT_ID**:
   - отправьте сообщение боту,  
   - затем откройте ссылку в браузере:  
     `https://api.telegram.org/bot<ВАШ_TOKEN>/getUpdates`
   - в ответе JSON найдите строку `"chat":{"id":<число>}` — это ваш CHAT_ID.

---

## 3️⃣ Настройка .env
1. Скопируйте файл `.env.example` → `.env`:
   ```bash
   cp .env.example .env
   ```

2. Откройте `.env` в любом текстовом редакторе и укажите ваши данные:
   ```
   TELEGRAM_BOT_TOKEN=123456789:ABCDEF...
   TELEGRAM_CHAT_ID=123456789
   ```

3. Остальные параметры можно оставить по умолчанию или изменить:
   - `EXPENSIVE_THRESHOLD_BTC=0.1` — порог для “дорогих” транзакций.  
   - `LARGE_THRESHOLD_BTC=0.5` — порог для “очень больших” транзакций.  
   - `Z_SCORE_TRIGGER=3.0` — чувствительность (уменьшите до 2.5, если сигналов мало).  
   - `WINDOW_SEC=300` — длина окна анализа (5 минут).

---

## 4️⃣ Запуск программы
1. Активируйте виртуальное окружение, если неактивно.
2. Запустите мониторинг с автоматической загрузкой `.env`:
   ```bash
   python run_with_env.py
   ```
   или напрямую:
   ```bash
   python main.py
   ```

3. Программа начнёт каждые 20 секунд опрашивать мемпул Bitcoin через API `mempool.space` и анализировать интенсивность транзакций.

4. Когда в сети произойдёт всплеск количества/объёма “дорогих” транзакций, в Telegram придёт уведомление формата:
   ```
   ⚡️ BTC: всплеск интенсивности дорогих транзакций
   Временное окно: 5 мин • 2025-10-23 18:25:00 UTC
   — Транзакций ≥ 0.1 BTC: 48
   — Объём: 57.8 BTC
   — Транзакций ≥ 0.5 BTC: 6
   ...
   ```

---

## 5️⃣ Полезные советы
- Чтобы уменьшить нагрузку на API — оставьте `POLL_INTERVAL_SEC=20` или больше.
- Если сигналов слишком много, увеличьте `Z_SCORE_TRIGGER` или `MIN_EXPENSIVE_COUNT`.
- Если хотите работать с вашим локальным нодом, замените в `.env` строку:
  ```
  ESPLORA_BASE=https://mempool.space/api
  ```
  на адрес вашего Esplora, например `http://127.0.0.1:5000/api`.

---

## 6️⃣ Остановка программы
Для остановки нажмите `Ctrl + C` в терминале или завершите процесс.

---

Готово ✅  
Теперь программа будет уведомлять вас в Telegram о всплесках крупных транзакций в сети Bitcoin.
